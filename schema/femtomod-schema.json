{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://github.com/your-org/omod/femtomod-schema.json",
  "title": "Femtomod - Minimal Orthographic-Phonetic Mappings with Orthoset Variants",
  "description": "Lightweight schema supporting multiple orthographic systems via differential encoding. Optimized for phonetic conversion tools, TTS/ASR preprocessing, and mobile applications.",
  "version": "1.0.0",
  "type": "object",
  "properties": {
    "l": {
      "type": "string",
      "pattern": "^[a-z]{4}[0-9]{4}$",
      "description": "Glottolog language identifier (4 lowercase letters + 4 digits)"
    },
    "s": {
      "type": "string",
      "enum": [
        "Adlm", "Ahom", "Arab", "Armi", "Armn", "Avst", "Bali", "Bamu", "Bass", "Batk",
        "Beng", "Bhks", "Bopo", "Brah", "Brai", "Bugi", "Buhd", "Cakm", "Cans", "Cari",
        "Cham", "Cher", "Chrs", "Copt", "Cprt", "Cyrl", "Deva", "Dogr", "Dsrt", "Dupl",
        "Egyp", "Elba", "Elym", "Ethi", "Geor", "Glag", "Gong", "Gonm", "Goth", "Gran",
        "Grek", "Gujr", "Guru", "Hang", "Hani", "Hano", "Hans", "Hant", "Hatr", "Hebr",
        "Hira", "Hluw", "Hmng", "Hmnp", "Hrkt", "Hung", "Ital", "Java", "Jpan", "Kali",
        "Kana", "Khar", "Khmr", "Khoj", "Kits", "Knda", "Kore", "Kthi", "Lana", "Laoo",
        "Latn", "Lepc", "Limb", "Lina", "Linb", "Lisu", "Lyci", "Lydi", "Mahj", "Maka",
        "Mand", "Mani", "Marc", "Medf", "Mend", "Merc", "Mero", "Mlym", "Modi", "Mong",
        "Mroo", "Mtei", "Mult", "Mymr", "Nand", "Narb", "Nbat", "Newa", "Nkoo", "Nshu",
        "Ogam", "Olck", "Orkh", "Orya", "Osge", "Osma", "Palm", "Pauc", "Perm", "Phag",
        "Phli", "Phlp", "Phnx", "Plrd", "Prti", "Qaag", "Rjng", "Rohg", "Runr", "Samr",
        "Sarb", "Saur", "Sgnw", "Shaw", "Shrd", "Sidd", "Sind", "Sinh", "Sogd", "Sogo",
        "Sora", "Soyo", "Sund", "Sylo", "Syrc", "Tagb", "Takr", "Tale", "Talu", "Taml",
        "Tang", "Tavt", "Telu", "Tfng", "Tglg", "Thaa", "Thai", "Tibt", "Tirh", "Ugar",
        "Vaii", "Wara", "Wcho", "Xpeo", "Xsux", "Yezi", "Yiii", "Zanb", "Zinh", "Zyyy"
      ],
      "description": "ISO 15924 4-letter script code for major writing systems"
    },
    "b": {
      "type": "string",
      "pattern": "^[a-z][a-z0-9-]*$",
      "description": "ID of the base orthoset (most complete/standard), must be lowercase alphanumeric with hyphens"
    },
    "m": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "g": {
            "type": "string",
            "minLength": 1,
            "description": "Glyphon (written form)"
          },
          "p": {
            "type": "string",
            "pattern": "^[a-zɑɐɒæɓʙβɔɕçɗɖðɘəɚɛɜɝɞɟʄɡɠɢʛɦɧħɥʜɨɪʝɭɬɫɮʟɱɯɰŋɳɲɴøɵɸθœɶʘɹɺɾɻʀʁɽʂʃʈʧʉʊʋⱱɤɣɤχʎʏʑʐʒʔʕʢʡˈˌːˑ̥̊̍̃̽͢ʰʷʲʶʷⁿˠˤˀˁˤ̴̴̴̥̥̊̍̽̃̽̃̊]+$",
            "description": "Primary IPA phoneme using standard IPA characters (no slashes/brackets)"
          },
          "c": {
            "type": "array",
            "items": {
              "type": "string",
              "enum": ["i", "m", "f", "s"]
            },
            "uniqueItems": true,
            "description": "Context: i=initial, m=medial, f=final, s=standalone"
          },
          "f": {
            "type": "string",
            "enum": ["c", "u", "r", "a", "o"],
            "description": "Frequency: c=common, u=uncommon, r=rare, a=archaic, o=obsolete"
          },
          "a": {
            "type": "string",
            "pattern": "^[^/\\[\\]]+$",
            "minLength": 1,
            "description": "Single most common alternate pronunciation (clean IPA notation)"
          }
        },
        "required": ["g", "p", "c"],
        "additionalProperties": false
      },
      "minItems": 1,
      "description": "Base orthoset mappings"
    },
    "v": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "i": {
            "type": "string",
            "pattern": "^[a-z][a-z0-9-]*$",
            "description": "Orthoset variant identifier (lowercase alphanumeric with hyphens)"
          },
          "n": {
            "type": "string",
            "description": "Human-readable variant name"
          },
          "t": {
            "type": "string",
            "description": "Time period or usage context"
          },
          "o": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "x": {
                  "type": "string",
                  "enum": ["add", "del", "mod", "map"],
                  "description": "Operation: add new mapping, delete mapping, modify existing, or remap grapheme"
                },
                "g": {
                  "type": "string",
                  "description": "Target glyphon"
                },
                "r": {
                  "type": "string",
                  "description": "For 'map' op: maps this glyphon to existing base glyphon"
                },
                "p": {
                  "type": "string",
                  "pattern": "^[^/\\[\\]]+$",
                  "minLength": 1,
                  "description": "For 'add'/'mod' ops: IPA phoneme (clean notation, no slashes/brackets)"
                },
                "c": {
                  "type": "array",
                  "items": {
                    "type": "string",
                    "enum": ["i", "m", "f", "s"]
                  },
                  "description": "For 'add'/'mod' ops: new contexts"
                },
                "f": {
                  "type": "string",
                  "enum": ["c", "u", "r", "a", "o"],
                  "description": "For 'add'/'mod' ops: frequency (c=common, u=uncommon, r=rare, a=archaic, o=obsolete)"
                }
              },
              "required": ["x", "g"],
              "additionalProperties": false
            },
            "description": "Differential operations from base orthoset"
          }
        },
        "required": ["i", "o"],
        "additionalProperties": false
      },
      "description": "Orthoset variants as deltas from base"
    }
  },
  "required": ["l", "s", "m"],
  "additionalProperties": false,
  "if": {
    "properties": {
      "v": {
        "type": "array",
        "minItems": 1
      }
    },
    "required": ["v"]
  },
  "then": {
    "required": ["l", "s", "b", "m", "v"]
  },
  "examples": [
    {
      "l": "hawa1245",
      "s": "Latn",
      "b": "standard",
      "m": [
        {"g": "a", "p": "a", "c": ["i", "m", "f", "s"]},
        {"g": "k", "p": "k", "c": ["i", "m", "f"], "a": "t"}
      ],
      "v": [
        {
          "i": "casual",
          "n": "Casual Hawaiian",
          "o": [
            {"x": "add", "g": "'", "p": "ʔ", "c": ["i", "m"]}
          ]
        }
      ]
    },
    {
      "l": "tami1289",
      "s": "Taml",
      "m": [
        {"g": "அ", "p": "a", "c": ["i", "m", "s"]},
        {"g": "க", "p": "ka", "c": ["i", "m"]}
      ]
    }
  ]
}
